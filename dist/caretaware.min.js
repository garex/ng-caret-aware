/**
 * Copyright (c) 2017, Leo Di Donato <leodidonato@gmail.com>
 * dist/caretaware.min.js - AngularJS directive for caret aware elements
 * @version 0.3.2
 * @link http://github.com/leodido/ng-caret-aware
 * @license MIT
 */
(function(){function m(d,f,n){function e(a){var g=(c.value||'').replace(/\r/g,'').length,b=~~a;0>b?b=g+a:b>g&&(b=g);return b}var c=f[0];f='setSelectionRange'in c||'selectionStart'in c;var r='createTextRange'in c||'selection'in document,b=this;switch(!0){case f:var h=function(){var a=c.selectionStart,b=c.selectionEnd,d=b-a;return{start:a,end:b,length:d,text:c.value.substr(a,d)}};var k=function(a){a=e(a);c.focus();c.setSelectionRange(a,a);c.selectionStart=a;c.selectionEnd=a;d[b.a()]=a};var l=function(a){var b=
c.selectionStart;var d=c.selectionEnd;var e=c.scrollTop;var f=c.scrollLeft;c.value=c.value.substr(0,b)+a+c.value.substr(d);a=b+a.length;c.selectionStart=a;c.selectionEnd=a;c.scrollTop=e;c.scrollLeft=f};break;case r:h=function(){c.focus();var a=document.selection.createRange();if(null===a)return{start:0,end:c.value.length,length:0};var b=c.createTextRange(),d=b.duplicate();b.moveToBookmark(a.getBookmark());d.setEndPoint('EndToStart',b);b=d.text.length;a=a.text;d=a.length;return{start:b,end:b+d,length:d,
text:a}};k=function(a){a=e(a);var g=c.createTextRange();g.move('character',a);g.select();d[b.a()]=a};l=function(a){var b=c.ownerDocument.selection.createRange();b.text=a;b.move('character',0);b.select()};break;default:h=function(){return{start:0,end:0,length:0,text:''}},k=function(){},l=function(a){c.value+=a;c.scrollTop=1E5}}var p=n.caretAware||'caret';d[p]=0;b.a=function(){return p};b.setPosition=function(a){if(!isNaN(parseFloat(a))&&isFinite(a))return k(a),b;throw new TypeError('Position MUST be numeric.');
};b.b=function(){return h().start};b.getSelection=h;b.c=function(a){l(a);return b};b.getNamespace=b.a;b.setPosition=b.setPosition;b.getPosition=b.b;b.setSelectionText=b.c}m.$inject=['$scope','$element','$attrs'];function q(){}q.prototype.link=function(d,f,n,e){f.on('keydown keyup click',function(){d.$evalAsync(function(){d[e.a()]=e.b()})});d.$watch(e.a(),function(c){e.b()!==c&&e.setPosition(c)});d.$on('$destroy',function(){delete d[e.a()];f.off('keydown keyup click')})};angular.module('leodido.caretAware',[]).directive('caretAware',function(){var d=new q;return{restrict:'AC',require:'caretAware',controller:m,link:d.link}});})();